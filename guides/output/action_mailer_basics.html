<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport"    content="width=device-width, initial-scale=1"/>
<meta name="description" content="Ruby on Rails ガイド：体系的に Rails を学ぼう (Rails 4.2 対応)" />
<meta name="keywords"    content="Ruby Rails Guides ガイド 体系的 学ぶ 無料 ウェブ Web 開発" />
<meta name="author"      content="Ruby on Rails Community" />

<meta property="fb:admins"      content="715330868" />
<meta property="og:title"       content="Ruby on Rails ガイド"/>
<meta property="og:site_name"   content="Ruby on Rails ガイド"/>
<meta property="og:image"       content="http://railsguides.jp/images/rails_guides_logo.gif"/>
<meta property="og:url"         content="http://railsguides.jp/" />
<meta property="og:type"        content="article" />
<meta property="og:description" content="Ruby on Rails ガイド：体系的に Rails 学ぼう (Rails 4.2 対応)" />

<title>Action Mailerの基礎 — Rails ガイド</title>
<link rel="stylesheet" type="text/css" href="stylesheets/style.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

<link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shCore.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shThemeRailsGuides.css" />

<link rel="stylesheet" type="text/css" href="stylesheets/fixes.css" />

<link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
</head>
<body class="guide">
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=614116885378153&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">関連サイト: </strong>
      <span class="red-button more-info-button">関連URL</span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="http://guides.rubyonrails.org/">原著 (英語)</a></li>
        <li class="more-info"><a href="https://github.com/yasslab/railsguides.jp">ソースコード (GitHub)</a></li>
        <li class="more-info"><a href="http://railstutorial.jp/">Rails チュートリアル</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="/" title="Return to home page">railsguides.jp</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="/">ホーム</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">ガイド目次</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
              <dl class="L">
                <dt>はじめに</dt>
                <dd><a href="getting_started.html">Rails をはじめよう</a></dd>
                <dt>モデル</dt>
                <dd><a href="active_record_basics.html">Active Record の基礎</a></dd>
                <dd><a href="active_record_migrations.html">Active Record マイグレーション</a></dd>
                <dd><a href="active_record_validations.html">Active Record バリデーション</a></dd>
                <dd><a href="active_record_callbacks.html">Active Record コールバック</a></dd>
                <dd><a href="association_basics.html">Active Record の関連付け</a></dd>
                <dd><a href="active_record_querying.html">Active Record クエリインターフェイス</a></dd>
                <dd><a href="active_model_basics.html">Active Model の基礎</a></dd>
                <dt>ビュー</dt>
                <dd><a href="layouts_and_rendering.html">レイアウトとレンダリング</a></dd>
                <dd><a href="form_helpers.html">Action View フォームヘルパー</a></dd>
                <dt>コントローラ</dt>
                <dd><a href="action_controller_overview.html">Action Controller の概要</a></dd>
                <dd><a href="routing.html">Rails ルーティング</a></dd>
              </dl>
              <dl class="R">
                <dt>高度なトピック</dt>
                <dd><a href="active_support_core_extensions.html">Active Support コア拡張機能</a></dd>
                <dd><a href="i18n.html">Rails 国際化 (i18n) API</a></dd>
                <dd><a href="action_mailer_basics.html">Action Mailer Basics [未着手]</a></dd>
                <dd><a href="active_job_basics.html">Active Job の基礎</a></dd>
                <dd><a href="security.html">Rails セキュリティガイド</a></dd>
                <dd><a href="debugging_rails_applications.html">Debugging Rails Applications [未着手]</a></dd>
                <dd><a href="configuring.html">Rails アプリケーションを設定する</a></dd>
                <dd><a href="command_line.html">コマンドラインツールと Rake タスク</a></dd>
                <dd><a href="asset_pipeline.html">アセットパイプライン</a></dd>
                <dd><a href="working_with_javascript_in_rails.html">Rails で JavaScript を使用する</a></dd>
                <dd><a href="constant_autoloading_and_reloading.html">Constant Autoloading and Reloading [未着手]</a></dd>
                <dt>Rails を拡張する</dt>
                <dd><a href="rails_on_rack.html">Rails と Rack</a></dd>
                <dd><a href="generators.html">Creating and Customizing Rails Generators [未着手]</a></dd>
                <dt>Contributing to Ruby on Rails [未着手]</dt>
                <dd><a href="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails [未着手]</a></dd>
                <dd><a href="api_documentation_guidelines.html">APIドキュメント作成ガイドライン</a></dd>
                <dd><a href="ruby_on_rails_guides_guidelines.html">Rails ガイドのガイドライン</a></dd>
                <dt>メンテナンスポリシー</dt>
                <dd><a href="maintenance_policy.html">メンテナンスポリシー</a></dd>
                <dt>リリースノート</dt>
                <dd><a href="upgrading_ruby_on_rails.html">Rails アップグレードガイド</a></dd>
                <dd><a href="4_2_release_notes.html">Ruby on Rails 4.2 リリースノート</a></dd>
                <dd><a href="4_1_release_notes.html">Ruby on Rails 4.1 リリースノート</a></dd>
                <dd><a href="4_0_release_notes.html">Ruby on Rails 4.0 Release Notes [未着手]</a></dd>
                <dd><a href="3_2_release_notes.html">Ruby on Rails 3.2 Release Notes [未着手]</a></dd>
                <dd><a href="3_1_release_notes.html">Ruby on Rails 3.1 Release Notes [未着手]</a></dd>
                <dd><a href="3_0_release_notes.html">Ruby on Rails 3.0 Release Notes [未着手]</a></dd>
                <dd><a href="2_3_release_notes.html">Ruby on Rails 2.3 Release Notes [未着手]</a></dd>
                <dd><a href="2_2_release_notes.html">Ruby on Rails 2.2 Release Notes [未着手]</a></dd>
              </dl>
          </div>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">貢献する</a></li>
        <li><a class="nav-item" href="credits.html">原著者</a></li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">ガイド目次</option>
              <optgroup label="はじめに">
                  <option value="getting_started.html">Rails をはじめよう</option>
              </optgroup>
              <optgroup label="モデル">
                  <option value="active_record_basics.html">Active Record の基礎</option>
                  <option value="active_record_migrations.html">Active Record マイグレーション</option>
                  <option value="active_record_validations.html">Active Record バリデーション</option>
                  <option value="active_record_callbacks.html">Active Record コールバック</option>
                  <option value="association_basics.html">Active Record の関連付け</option>
                  <option value="active_record_querying.html">Active Record クエリインターフェイス</option>
                  <option value="active_model_basics.html">Active Model の基礎</option>
              </optgroup>
              <optgroup label="ビュー">
                  <option value="layouts_and_rendering.html">レイアウトとレンダリング</option>
                  <option value="form_helpers.html">Action View フォームヘルパー</option>
              </optgroup>
              <optgroup label="コントローラ">
                  <option value="action_controller_overview.html">Action Controller の概要</option>
                  <option value="routing.html">Rails ルーティング</option>
              </optgroup>
              <optgroup label="高度なトピック">
                  <option value="active_support_core_extensions.html">Active Support コア拡張機能</option>
                  <option value="i18n.html">Rails 国際化 (i18n) API</option>
                  <option value="action_mailer_basics.html">Action Mailer Basics [未着手]</option>
                  <option value="active_job_basics.html">Active Job の基礎</option>
                  <option value="security.html">Rails セキュリティガイド</option>
                  <option value="debugging_rails_applications.html">Debugging Rails Applications [未着手]</option>
                  <option value="configuring.html">Rails アプリケーションを設定する</option>
                  <option value="command_line.html">コマンドラインツールと Rake タスク</option>
                  <option value="asset_pipeline.html">アセットパイプライン</option>
                  <option value="working_with_javascript_in_rails.html">Rails で JavaScript を使用する</option>
                  <option value="constant_autoloading_and_reloading.html">Constant Autoloading and Reloading [未着手]</option>
              </optgroup>
              <optgroup label="Rails を拡張する">
                  <option value="rails_on_rack.html">Rails と Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators [未着手]</option>
              </optgroup>
              <optgroup label="Contributing to Ruby on Rails [未着手]">
                  <option value="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails [未着手]</option>
                  <option value="api_documentation_guidelines.html">APIドキュメント作成ガイドライン</option>
                  <option value="ruby_on_rails_guides_guidelines.html">Rails ガイドのガイドライン</option>
              </optgroup>
              <optgroup label="メンテナンスポリシー">
                  <option value="maintenance_policy.html">メンテナンスポリシー</option>
              </optgroup>
              <optgroup label="リリースノート">
                  <option value="upgrading_ruby_on_rails.html">Rails アップグレードガイド</option>
                  <option value="4_2_release_notes.html">Ruby on Rails 4.2 リリースノート</option>
                  <option value="4_1_release_notes.html">Ruby on Rails 4.1 リリースノート</option>
                  <option value="4_0_release_notes.html">Ruby on Rails 4.0 Release Notes [未着手]</option>
                  <option value="3_2_release_notes.html">Ruby on Rails 3.2 Release Notes [未着手]</option>
                  <option value="3_1_release_notes.html">Ruby on Rails 3.1 Release Notes [未着手]</option>
                  <option value="3_0_release_notes.html">Ruby on Rails 3.0 Release Notes [未着手]</option>
                  <option value="2_3_release_notes.html">Ruby on Rails 2.3 Release Notes [未着手]</option>
                  <option value="2_2_release_notes.html">Ruby on Rails 2.2 Release Notes [未着手]</option>
              </optgroup>
          </select>
        </li>
      </ul>
      </div>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Action Mailerの基礎</h2><p>本章では、アプリケーションでメールの送受信を行えるようにするために必要なすべての事項と、Action Mailerのさまざまな内部情報を提供します。また、メイラーのテスト方法についても説明します。</p><p>このガイドの内容:</p>
<ul>
<li>Railsアプリケーションでメールを送受信する方法</li>
<li>Action Mailerクラスとメイラービューの生成および編集方法</li>
<li>環境に合わせてAction Mailerを設定する方法</li>
<li>Action Mailerクラスのテスト方法</li>
</ul>

                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />目次</h3>
            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<ol class="chapters">
<li><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></li>
<li>
<a href="#%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E9%80%81%E4%BF%A1%E3%81%99%E3%82%8B">メールを送信する</a>

<ul>
<li><a href="#%E3%83%A1%E3%82%A4%E3%83%A9%E3%83%BC%E7%94%9F%E6%88%90%E3%81%AE%E5%85%A8%E6%89%8B%E9%A0%86">メイラー生成の全手順</a></li>
<li><a href="#%E3%83%98%E3%83%83%E3%83%80%E3%83%BC%E3%81%AE%E5%80%A4%E3%82%92%E8%87%AA%E5%8B%95%E3%82%A8%E3%83%B3%E3%82%B3%E3%83%BC%E3%83%89%E3%81%99%E3%82%8B">ヘッダーの値を自動エンコードする</a></li>
<li><a href="#action-mailer%E3%81%AE%E5%85%A8%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89">Action Mailerの全メソッド</a></li>
<li><a href="#mailer-views">Mailer Views</a></li>
<li><a href="#action-mailer-layouts">Action Mailer Layouts</a></li>
<li><a href="#generating-urls-in-action-mailer-views">Generating URLs in Action Mailer Views</a></li>
<li><a href="#sending-multipart-emails">Sending Multipart Emails</a></li>
<li><a href="#sending-emails-with-dynamic-delivery-options">Sending Emails with Dynamic Delivery Options</a></li>
<li><a href="#sending-emails-without-template-rendering">Sending Emails without Template Rendering</a></li>
</ul>
</li>
<li><a href="#receiving-emails">Receiving Emails</a></li>
<li><a href="#action-mailer-callbacks">Action Mailer Callbacks</a></li>
<li><a href="#using-action-mailer-helpers">Using Action Mailer Helpers</a></li>
<li>
<a href="#action-mailer-configuration">Action Mailer Configuration</a>

<ul>
<li><a href="#example-action-mailer-configuration">Example Action Mailer Configuration</a></li>
<li><a href="#action-mailer-configuration-for-gmail">Action Mailer Configuration for Gmail</a></li>
</ul>
</li>
<li><a href="#mailer-testing">Mailer Testing</a></li>
<li><a href="#intercepting-emails">Intercepting Emails</a></li>
</ol>
</body></html>

          </div>
</div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<h3 id="はじめに">1 はじめに</h3>
<p>Action Mailerを使用することで、アプリケーションのメイラークラスやビューでメールを送信することができます。メイラーの動作はコントローラときわめて似通っています。メイラーは<code>ActionMailer::Base</code>を継承し、<code>app/mailers</code>に配置され、<code>app/views</code>にあるビューと結び付けられます。</p>
<h3 id="メールを送信する">2 メールを送信する</h3>
<p>このセクションでは、メイラーとビューの作成方法を手順を追って説明します。</p>
<h4 id="メイラー生成の全手順">2.1 メイラー生成の全手順</h4>
<h5 id="メイラーを作成する">2.1.1 メイラーを作成する</h5>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
$ bin/rails generate mailer UserMailer
create  app/mailers/user_mailer.rb
invoke  erb
create    app/views/user_mailer
invoke  test_unit
create    test/mailers/user_mailer_test.rb

</pre>
</div>
<p>上に示したとおり、Railsの他のジェネレータ同様の方法でメイラーを生成できます。メイラーは概念上コントローラと似通っており、メイラーを生成すると (コントローラと同様に) ビューのディレクトリとテストも同時に生成されます。</p>
<p>ジェネレータを使用したくない場合は、app/mailersディレクトリ以下にファイルを作成し、<code>ActionMailer::Base</code>を継承してください。</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class MyMailer &lt; ActionMailer::Base
end

</pre>
</div>
<h5 id="メイラーを編集する">2.1.2 メイラーを編集する</h5>
<p>メイラーはRailsのコントローラと非常に似通っています。メイラーには「アクション」と呼ばれるメソッドがあり、メールのコンテンツを構成するのにビューを使用します。コントローラでHTMLなどのメールコンテンツを生成して顧客に送信したい場合、その箇所でメイラーを使用して、送信したいメッセージを作成します。●</p>
<p><code>app/mailers/user_mailer.rb</code>には空のメイラーがあります。</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  default from: 'from@example.com'
end

</pre>
</div>
<p><code>welcome_email</code>という名前のメソッドを追加し、ユーザーが登録したメールアドレスにメールを送信できるようにしてみましょう。</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  default from: 'notifications@example.com'

  def welcome_email(user)
    @user = user
    @url  = 'http://example.com/login'
    mail(to: @user.email, subject: 'Welcome to My Awesome Site')
  end
end

</pre>
</div>
<p>上のメソッドで使用されている項目について簡単に説明します。利用可能なすべてのオプションについては、「Action Mailerの全メソッド」セクションでユーザー設定可能な属性を参照してください。</p>
<ul>
<li>
<code>default Hash</code> - メイラーから送信するあらゆるメールで使用されるデフォルト値のハッシュです。上の例の場合、<code>:from</code>ヘッダーにこのクラスのすべてのメッセージで使用する値を1つ設定しています。この値はメールごとに上書きすることもできます。</li>
<li>
<code>mail</code> - 実際のメール・メッセージです。ここでは<code>:to</code>ヘッダーと<code>:subject</code>ヘッダーを渡しています。</li>
</ul>
<p>コントローラの場合と同様、メイラーのメソッド内で定義されたすべてのインスタンス変数はそのままビューで使用できます。</p>
<h5 id="メイラービューを作成する">2.1.3 メイラービューを作成する</h5>
<p><code>app/views/user_mailer/</code>ディレクトリで<code>welcome_email.html.erb</code>というファイルを1つ作成してください。このファイルを、HTMLでフォーマットされたメールテンプレートにします。</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta content='text/html; charset=UTF-8' http-equiv='Content-Type' /&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;&lt;%= @user.name %&gt;様、example.comへようこそ。&lt;/h1&gt;
      &lt;p&gt;
      example.comへのサインアップが成功しました。
      ユーザー名は「&lt;%= @user.login %&gt;」です。&lt;br&gt;
    &lt;/p&gt;
    &lt;p&gt;
      このサイトにログインするには、&lt;%= @url %&gt;をクリックしてください。
    &lt;/p&gt;
    &lt;p&gt;ご入会ありがとうございます。どうぞお楽しみくださいませ。&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;

</pre>
</div>
<p>続いて、同じ内容のテキストメールも作成しましょう。顧客によってはHTMLフォーマットのメールを受け取りたくない人もいるので、テキストメールも作成しておくのが最善です。これを行なうには、<code>app/views/user_mailer/</code>ディレクトリで<code>welcome_email.text.erb</code>というファイルを以下の内容で作成してください。</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= @user.name %&gt;様、example.comへようこそ。
===============================================

example.comへのサインアップが成功しました。ユーザー名は「&lt;%= @user.login %&gt;」です。

このサイトにログインするには、&lt;%= @url %&gt;をクリックしてください。

本サイトにユーザー登録いただきありがとうございます。

</pre>
</div>
<p>現在のAction Mailerでは、<code>mail</code>メソッドを呼び出すと2種類のテンプレート (テキストおよびHTML) があるかどうかを探し、<code>multipart/alternative</code>形式のメールを自動生成します。</p>
<h5 id="メイラーを呼び出す">2.1.4 メイラーを呼び出す</h5>
<p>Railsのメイラーは、ビューのレンダリングと本質的に同じことを行っています。ビューのレンダリングではHTTPプロトコルとして送信されますが、メイラーではメールのプロトコルを経由して送信する点のみが異なります。従って、ユーザー作成に成功したときにメールを送信するようコントローラからメイラーに指示するだけで機能するようになります。</p>
<p>メイラー呼び出しは非常に簡単です。</p>
<p>例として、最初にscaffoldで<code>User</code>を作成してみましょう。</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
$ bin/rails generate scaffold user name email login
$ bin/rake db:migrate

</pre>
</div>
<p>説明用のユーザーモデルを作成したので、続いて<code>app/controllers/users_controller.rb</code>を編集し、新規ユーザーの保存成功直後に<code>UserMailer</code>の<code>UserMailer.welcome_email</code>を使用してそのユーザーにメールが送信されるようにしましょう。</p>
<p>Action MailerはActive Jobとうまく統合されているので、Webのリクエスト/レスポンスサイクルの外で非同期にメールを送信できます。このおかげで、ユーザーは送信完了を待つ必要がありません。</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UsersController &lt; ApplicationController
  # POST /users
  # POST /users.json
  def create
    @user = User.new(params[:user])

    respond_to do |format|
      if @user.save
        # 保存後にUserMailerを使用してwelcomeメールを送信
        UserMailer.welcome_email(@user).deliver_later

        format.html { redirect_to(@user, notice: 'ユーザーが正常に作成されました。') }
        format.json { render json: @user, status: :created, location: @user }
      else
        format.html { render action: 'new' }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end
end

</pre>
</div>
<div class="note"><p>Active Jobはデフォルトでジョブを':inline'で実行します。したがって、この時点で<code>deliver_later</code>を使用してメールを送信できます。また、メールを後でバックグラウンドジョブから送信したい場合は、SidekiqやResqueなどのバックエンドクエリシステムを使用するようActive Jobを設定するだけで済みます。</p></div>
<p>メールをcronjobなどから今すぐ送信したい場合は、<code>deliver_now</code>を呼び出すだけで済みます。</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class SendWeeklySummary
  def run
    User.find_each do |user|
      UserMailer.weekly_summary(user).deliver_now
    end
  end
end

</pre>
</div>
<p>この<code>welcome_email</code>メソッドは<code>ActionMailer::MessageDelivery</code>オブジェクトを1つ返します。このオブジェクトは、そのメール自身が送信対象であることを<code>deliver_now</code>や<code>deliver_later</code>に伝えます。<code>ActionMailer::MessageDelivery</code>オブジェクトは、<code>Mail::Message</code>をラップしています。内部の<code>Mail::Message</code>オブジェクトの表示や変更などを行いたい場合は、<code>ActionMailer::MessageDelivery</code>オブジェクトの<code>message</code>メソッドにアクセスします。</p>
<h4 id="ヘッダーの値を自動エンコードする">2.2 ヘッダーの値を自動エンコードする</h4>
<p>Action Mailerは、メールのヘッダーや本文のマルチバイト文字を自動的にエンコードします。</p>
<p>別の文字セットを定義したい場合や、事前に手動で別のエンコードを行っておきたい場合などの複雑な事例については、<a href="https://github.com/mikel/mail">Mail</a>ライブラリを参照してください。</p>
<h4 id="action-mailerの全メソッド">2.3 Action Mailerの全メソッド</h4>
<p>以下の3つのメソッドを使用すれば、ほとんどのメール送信をカバーできます。</p>
<ul>
<li>
<code>headers</code> - メールに追加したいヘッダーを指定します。メールヘッダーのフィールド名と値のペアをハッシュにまとめて渡すこともできますし、<code>headers[:field_name] = 'value'</code>のように呼び出すこともできます。</li>
<li>
<code>attachments</code> - メールにファイルを添付します。<code>attachments['file-name.jpg'] = File.read('file-name.jpg')</code>のように記述します。</li>
<li>
<code>mail</code> - 実際のメール自身を送信します。このメソッドにはヘッダーのハッシュをパラメータとして渡すことができます。メソッドを呼び出すと、定義しておいたメールテンプレートに応じて、プレーンテキストメールまたはマルチパートメールを送信します。</li>
</ul>
<h5 id="ファイルを添付する">2.3.1 ファイルを添付する</h5>
<p>Action Mailerではファイルを簡単に添付できます。</p>
<ul>
<li>
<p>ファイル名とコンテンツPass the file name and content and Action Mailer and the <a href="https://github.com/mikel/mail">Mail gem</a> will automatically guess the mime_type, set the encoding and create the attachment.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
attachments['filename.jpg'] = File.read('/path/to/filename.jpg')

</pre>
</div>
</li>
</ul>
<p>  When the <code>mail</code> method will be triggered, it will send a multipart email with an attachment, properly nested with the top level being <code>multipart/mixed</code> and the first part being a <code>multipart/alternative</code> containing the plain text and HTML email messages.</p>
<div class="note"><p>Mail will automatically Base64 encode an attachment. If you want something different, encode your content and pass in the encoded content and encoding in a <code>Hash</code> to the <code>attachments</code> method.</p></div>
<ul>
<li>
<p>Pass the file name and specify headers and content and Action Mailer and Mail will use the settings you pass in.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
encoded_content = SpecialEncode(File.read('/path/to/filename.jpg'))
attachments['filename.jpg'] = {
  mime_type: 'application/x-gzip',
  encoding: 'SpecialEncoding',
  content: encoded_content
}

</pre>
</div>
</li>
</ul>
<div class="note"><p>If you specify an encoding, Mail will assume that your content is already encoded and not try to Base64 encode it.</p></div>
<h5 id="making-inline-attachments">2.3.2 Making Inline Attachments</h5>
<p>Action Mailer 3.0 makes inline attachments, which involved a lot of hacking in pre 3.0 versions, much simpler and trivial as they should be.</p>
<ul>
<li>
<p>First, to tell Mail to turn an attachment into an inline attachment, you just call <code>#inline</code> on the attachments method within your Mailer:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
def welcome
  attachments.inline['image.jpg'] = File.read('/path/to/image.jpg')
end

</pre>
</div>
</li>
<li>
<p>Then in your view, you can just reference <code>attachments</code> as a hash and specify which attachment you want to show, calling <code>url</code> on it and then passing the result into the <code>image_tag</code> method:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&lt;p&gt;Hello there, this is our image&lt;/p&gt;

&lt;%= image_tag attachments['image.jpg'].url %&gt;

</pre>
</div>
</li>
<li>
<p>As this is a standard call to <code>image_tag</code> you can pass in an options hash after the attachment URL as you could for any other image:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&lt;p&gt;Hello there, this is our image&lt;/p&gt;

&lt;%= image_tag attachments['image.jpg'].url, alt: 'My Photo', class: 'photos' %&gt;

</pre>
</div>
</li>
</ul>
<h5 id="sending-email-to-multiple-recipients">2.3.3 Sending Email To Multiple Recipients</h5>
<p>It is possible to send email to one or more recipients in one email (e.g., informing all admins of a new signup) by setting the list of emails to the <code>:to</code> key. The list of emails can be an array of email addresses or a single string with the addresses separated by commas.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class AdminMailer &lt; ActionMailer::Base
  default to: Proc.new { Admin.pluck(:email) },
          from: 'notification@example.com'

  def new_registration(user)
    @user = user
    mail(subject: "New User Signup: #{@user.email}")
  end
end

</pre>
</div>
<p>The same format can be used to set carbon copy (Cc:) and blind carbon copy (Bcc:) recipients, by using the <code>:cc</code> and <code>:bcc</code> keys respectively.</p>
<h5 id="sending-email-with-name">2.3.4 Sending Email With Name</h5>
<p>Sometimes you wish to show the name of the person instead of just their email address when they receive the email. The trick to doing that is to format the email address in the format <code>"Full Name &lt;email&gt;"</code>.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
def welcome_email(user)
  @user = user
  email_with_name = %("#{@user.name}" &lt;#{@user.email}&gt;)
  mail(to: email_with_name, subject: 'Welcome to My Awesome Site')
end

</pre>
</div>
<h4 id="mailer-views">2.4 Mailer Views</h4>
<p>Mailer views are located in the <code>app/views/name_of_mailer_class</code> directory. The specific mailer view is known to the class because its name is the same as the mailer method. In our example from above, our mailer view for the <code>welcome_email</code> method will be in <code>app/views/user_mailer/welcome_email.html.erb</code> for the HTML version and <code>welcome_email.text.erb</code> for the plain text version.</p>
<p>To change the default mailer view for your action you do something like:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  default from: 'notifications@example.com'

  def welcome_email(user)
    @user = user
    @url  = 'http://example.com/login'
    mail(to: @user.email,
         subject: 'Welcome to My Awesome Site',
         template_path: 'notifications',
         template_name: 'another')
  end
end

</pre>
</div>
<p>In this case it will look for templates at <code>app/views/notifications</code> with name <code>another</code>.  You can also specify an array of paths for <code>template_path</code>, and they will be searched in order.</p>
<p>If you want more flexibility you can also pass a block and render specific templates or even render inline or text without using a template file:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  default from: 'notifications@example.com'

  def welcome_email(user)
    @user = user
    @url  = 'http://example.com/login'
    mail(to: @user.email,
         subject: 'Welcome to My Awesome Site') do |format|
      format.html { render 'another_template' }
      format.text { render text: 'Render text' }
    end
  end
end

</pre>
</div>
<p>This will render the template 'another_template.html.erb' for the HTML part and use the rendered text for the text part. The render command is the same one used inside of Action Controller, so you can use all the same options, such as <code>:text</code>, <code>:inline</code> etc.</p>
<h4 id="action-mailer-layouts">2.5 Action Mailer Layouts</h4>
<p>Just like controller views, you can also have mailer layouts. The layout name needs to be the same as your mailer, such as <code>user_mailer.html.erb</code> and <code>user_mailer.text.erb</code> to be automatically recognized by your mailer as a layout.</p>
<p>In order to use a different file, call <code>layout</code> in your mailer:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  layout 'awesome' # use awesome.(html|text).erb as the layout
end

</pre>
</div>
<p>Just like with controller views, use <code>yield</code> to render the view inside the layout.</p>
<p>You can also pass in a <code>layout: 'layout_name'</code> option to the render call inside the format block to specify different layouts for different formats:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  def welcome_email(user)
    mail(to: user.email) do |format|
      format.html { render layout: 'my_layout' }
      format.text
    end
end
end

</pre>
</div>
<p>Will render the HTML part using the <code>my_layout.html.erb</code> file and the text part with the usual <code>user_mailer.text.erb</code> file if it exists.</p>
<h4 id="generating-urls-in-action-mailer-views">2.6 Generating URLs in Action Mailer Views</h4>
<p>Unlike controllers, the mailer instance doesn't have any context about the incoming request so you'll need to provide the <code>:host</code> parameter yourself.</p>
<p>As the <code>:host</code> usually is consistent across the application you can configure it globally in <code>config/application.rb</code>:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
config.action_mailer.default_url_options = { host: 'example.com' }

</pre>
</div>
<p>Because of this behavior you cannot use any of the <code>*_path</code> helpers inside of an email. Instead you will need to use the associated <code>*_url</code> helper. For example instead of using</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&lt;%= link_to 'welcome', welcome_path %&gt;

</pre>
</div>
<p>You will need to use:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&lt;%= link_to 'welcome', welcome_url %&gt;

</pre>
</div>
<p>By using the full URL, your links will now work in your emails.</p>
<h5 id="generating-urls-with-url_for">2.6.1 generating URLs with <code>url_for</code>
</h5>
<p>You need to pass the <code>only_path: false</code> option when using <code>url_for</code>. This will ensure that absolute URLs are generated because the <code>url_for</code> view helper will, by default, generate relative URLs when a <code>:host</code> option isn't explicitly provided.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= url_for(controller: 'welcome',
            action: 'greeting',
            only_path: false) %&gt;

</pre>
</div>
<p>If you did not configure the <code>:host</code> option globally make sure to pass it to <code>url_for</code>.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= url_for(host: 'example.com',
            controller: 'welcome',
            action: 'greeting') %&gt;

</pre>
</div>
<div class="note"><p>When you explicitly pass the <code>:host</code> Rails will always generate absolute URLs, so there is no need to pass <code>only_path: false</code>.</p></div>
<h5 id="generating-urls-with-named-routes">2.6.2 generating URLs with named routes</h5>
<p>Email clients have no web context and so paths have no base URL to form complete web addresses. Thus, you should always use the "_url" variant of named route helpers.</p>
<p>If you did not configure the <code>:host</code> option globally make sure to pass it to the url helper.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= user_url(@user, host: 'example.com') %&gt;

</pre>
</div>
<h4 id="sending-multipart-emails">2.7 Sending Multipart Emails</h4>
<p>Action Mailer will automatically send multipart emails if you have different templates for the same action. So, for our UserMailer example, if you have <code>welcome_email.text.erb</code> and <code>welcome_email.html.erb</code> in <code>app/views/user_mailer</code>, Action Mailer will automatically send a multipart email with the HTML and text versions setup as different parts.</p>
<p>The order of the parts getting inserted is determined by the <code>:parts_order</code> inside of the <code>ActionMailer::Base.default</code> method.</p>
<h4 id="sending-emails-with-dynamic-delivery-options">2.8 Sending Emails with Dynamic Delivery Options</h4>
<p>If you wish to override the default delivery options (e.g. SMTP credentials) while delivering emails, you can do this using <code>delivery_method_options</code> in the mailer action.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  def welcome_email(user, company)
    @user = user
    @url  = user_url(@user)
    delivery_options = { user_name: company.smtp_user,
                         password: company.smtp_password,
                         address: company.smtp_host }
    mail(to: @user.email,
         subject: "Please see the Terms and Conditions attached",
         delivery_method_options: delivery_options)
  end
end

</pre>
</div>
<h4 id="sending-emails-without-template-rendering">2.9 Sending Emails without Template Rendering</h4>
<p>There may be cases in which you want to skip the template rendering step and supply the email body as a string. You can achieve this using the <code>:body</code> option. In such cases don't forget to add the <code>:content_type</code> option. Rails will default to <code>text/plain</code> otherwise.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  def welcome_email(user, email_body)
    mail(to: user.email,
         body: email_body,
         content_type: "text/html",
         subject: "Already rendered!")
  end
end

</pre>
</div>
<h3 id="receiving-emails">3 Receiving Emails</h3>
<p>Receiving and parsing emails with Action Mailer can be a rather complex endeavor. Before your email reaches your Rails app, you would have had to configure your system to somehow forward emails to your app, which needs to be listening for that. So, to receive emails in your Rails app you'll need to:</p>
<ul>
<li><p>Implement a <code>receive</code> method in your mailer.</p></li>
<li><p>Configure your email server to forward emails from the address(es) you would like your app to receive to <code>/path/to/app/bin/rails runner 'UserMailer.receive(STDIN.read)'</code>.</p></li>
</ul>
<p>Once a method called <code>receive</code> is defined in any mailer, Action Mailer will parse the raw incoming email into an email object, decode it, instantiate a new mailer, and pass the email object to the mailer <code>receive</code> instance method. 例: </p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  def receive(email)
    page = Page.find_by(address: email.to.first)
    page.emails.create(
      subject: email.subject,
      body: email.body
    )

    if email.has_attachments?
      email.attachments.each do |attachment|
        page.attachments.create({
          file: attachment,
          description: email.subject
        })
      end
    end
  end
end

</pre>
</div>
<h3 id="action-mailer-callbacks">4 Action Mailer Callbacks</h3>
<p>Action Mailer allows for you to specify a <code>before_action</code>, <code>after_action</code> and <code>around_action</code>.</p>
<ul>
<li><p>Filters can be specified with a block or a symbol to a method in the mailer class similar to controllers.</p></li>
<li><p>You could use a <code>before_action</code> to populate the mail object with defaults, delivery_method_options or insert default headers and attachments.</p></li>
<li><p>You could use an <code>after_action</code> to do similar setup as a <code>before_action</code> but using instance variables set in your mailer action.</p></li>
</ul>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class UserMailer &lt; ActionMailer::Base
  after_action :set_delivery_options,
               :prevent_delivery_to_guests,
               :set_business_headers

  def feedback_message(business, user)
    @business = business
    @user = user
    mail
  end

  def campaign_message(business, user)
    @business = business
    @user = user
  end

  private

    def set_delivery_options
      # You have access to the mail instance,
      # @business and @user instance variables here
      if @business &amp;&amp; @business.has_smtp_settings?
        mail.delivery_method.settings.merge!(@business.smtp_settings)
      end
    end

    def prevent_delivery_to_guests
      if @user &amp;&amp; @user.guest?
        mail.perform_deliveries = false
      end
    end

    def set_business_headers
      if @business
        headers["X-SMTPAPI-CATEGORY"] = @business.code
      end
    end
end

</pre>
</div>

<ul>
<li>Mailer Filters abort further processing if body is set to a non-nil value.</li>
</ul>
<h3 id="using-action-mailer-helpers">5 Using Action Mailer Helpers</h3>
<p>Action Mailer now just inherits from <code>AbstractController</code>, so you have access to the same generic helpers as you do in Action Controller.</p>
<h3 id="action-mailer-configuration">6 Action Mailer Configuration</h3>
<p>The following configuration options are best made in one of the environment files (environment.rb, production.rb, etc...)</p>
<table>
<thead>
<tr>
<th>Configuration</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>logger</code></td>
<td>Generates information on the mailing run if available. Can be set to <code>nil</code> for no logging. Compatible with both Ruby's own <code>Logger</code> and <code>Log4r</code> loggers.</td>
</tr>
<tr>
<td><code>smtp_settings</code></td>
<td>Allows detailed configuration for <code>:smtp</code> delivery method:<ul>
<li>
<code>:address</code> - Allows you to use a remote mail server. Just change it from its default <code>"localhost"</code> setting.</li>
<li>
<code>:port</code> - On the off chance that your mail server doesn't run on port 25, you can change it.</li>
<li>
<code>:domain</code> - If you need to specify a HELO domain, you can do it here.</li>
<li>
<code>:user_name</code> - If your mail server requires authentication, set the username in this setting.</li>
<li>
<code>:password</code> - If your mail server requires authentication, set the password in this setting.</li>
<li>
<code>:authentication</code> - If your mail server requires authentication, you need to specify the authentication type here. This is a symbol and one of <code>:plain</code>, <code>:login</code>, <code>:cram_md5</code>.</li>
<li>
<code>:enable_starttls_auto</code> - Set this to <code>false</code> if there is a problem with your server certificate that you cannot resolve.</li>
</ul>
</td>
</tr>
<tr>
<td><code>sendmail_settings</code></td>
<td>Allows you to override options for the <code>:sendmail</code> delivery method.<ul>
<li>
<code>:location</code> - The location of the sendmail executable. Defaults to <code>/usr/sbin/sendmail</code>.</li>
<li>
<code>:arguments</code> - The command line arguments to be passed to sendmail. Defaults to <code>-i -t</code>.</li>
</ul>
</td>
</tr>
<tr>
<td><code>raise_delivery_errors</code></td>
<td>Whether or not errors should be raised if the email fails to be delivered. This only works if the external email server is configured for immediate delivery.</td>
</tr>
<tr>
<td><code>delivery_method</code></td>
<td>Defines a delivery method. Possible values are:<ul>
<li>
<code>:smtp</code> (default), can be configured by using <code>config.action_mailer.smtp_settings</code>.</li>
<li>
<code>:sendmail</code>, can be configured by using <code>config.action_mailer.sendmail_settings</code>.</li>
<li>
<code>:file</code>: save emails to files; can be configured by using <code>config.action_mailer.file_settings</code>.</li>
<li>
<code>:test</code>: save emails to <code>ActionMailer::Base.deliveries</code> array.</li>
</ul>See <a href="http://api.rubyonrails.org/classes/ActionMailer/Base.html">API docs</a> for more info.</td>
</tr>
<tr>
<td><code>perform_deliveries</code></td>
<td>Determines whether deliveries are actually carried out when the <code>deliver</code> method is invoked on the Mail message. By default they are, but this can be turned off to help functional testing.</td>
</tr>
<tr>
<td><code>deliveries</code></td>
<td>Keeps an array of all the emails sent out through the Action Mailer with delivery_method :test. Most useful for unit and functional testing.</td>
</tr>
<tr>
<td><code>default_options</code></td>
<td>Allows you to set default values for the <code>mail</code> method options (<code>:from</code>, <code>:reply_to</code>, etc.).</td>
</tr>
</tbody>
</table>
<p>For a complete writeup of possible configurations see the <a href="configuring.html#configuring-action-mailer">Configuring Action Mailer</a> in our Configuring Rails Applications guide.</p>
<h4 id="example-action-mailer-configuration">6.1 Example Action Mailer Configuration</h4>
<p>An example would be adding the following to your appropriate <code>config/environments/$RAILS_ENV.rb</code> file:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
config.action_mailer.delivery_method = :sendmail
# Defaults to:
# config.action_mailer.sendmail_settings = {
#   location: '/usr/sbin/sendmail',
#   arguments: '-i -t'
# }
config.action_mailer.perform_deliveries = true
config.action_mailer.raise_delivery_errors = true
config.action_mailer.default_options = {from: 'no-reply@example.com'}

</pre>
</div>
<h4 id="action-mailer-configuration-for-gmail">6.2 Action Mailer Configuration for Gmail</h4>
<p>As Action Mailer now uses the <a href="https://github.com/mikel/mail">Mail gem</a>, this becomes as simple as adding to your <code>config/environments/$RAILS_ENV.rb</code> file:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = {
  address:              'smtp.gmail.com',
  port:                 587,
  domain:               'example.com',
  user_name:            '&lt;username&gt;',
  password:             '&lt;password&gt;',
  authentication:       'plain',
  enable_starttls_auto: true  }

</pre>
</div>
<h3 id="mailer-testing">7 Mailer Testing</h3>
<p>You can find detailed instructions on how to test your mailers in the <a href="testing.html#testing-your-mailers">testing guide</a>.</p>
<h3 id="intercepting-emails">8 Intercepting Emails</h3>
<p>There are situations where you need to edit an email before it's delivered. Fortunately Action Mailer provides hooks to intercept every email. You can register an interceptor to make modifications to mail messages right before they are handed to the delivery agents.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
class SandboxEmailInterceptor
  def self.delivering_email(message)
    message.to = ['sandbox@example.com']
  end
end

</pre>
</div>
<p>Before the interceptor can do its job you need to register it with the Action Mailer framework. You can do this in an initializer file <code>config/initializers/sandbox_email_interceptor.rb</code></p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
ActionMailer::Base.register_interceptor(SandboxEmailInterceptor) if Rails.env.staging?

</pre>
</div>
<div class="note"><p>The example above uses a custom environment called "staging" for a production like server but for testing purposes. You can read <a href="configuring.html#creating-rails-environments">Creating Rails environments</a> for more information about custom Rails environments.</p></div>
</body></html>


        <h3>フィードバックについて</h3>
        <p>
          本ガイドの訳文およびソースコードは、GitHub上の <a href="https://github.com/yasslab/railsguides.jp">yasslab/railsguides.jp</a> で管理・公開されております。
	  本ガイドを読んで、誤字・脱字・誤訳などを見かけましたら、上記リポジトリにてお気軽に <a href="https://github.com/yasslab/railsguides.jp/issues">Issue</a> を出して頂けると大変嬉しいです。また、「Pull Request を送りたい!」という場合には、<a href="ruby_on_rails_guides_guidelines.html">Ruby on Railsガイドのガイドライン</a>と、<a href="https://github.com/yasslab/railsguides.jp#%E7%BF%BB%E8%A8%B3%E3%81%AE%E6%B5%81%E3%82%8C">README</a>に記載されている「翻訳の流れ」をご参考にしてください。
	</p>
	<p>
	  なお、原著レベルでの間違いを見つけましたら、原著へのフィードバック方法 (<a href="http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">documentation contributions</a>) をご参考にしてください。
        </p>
        <p>
	  本ガイドの品質向上に向けて、皆さまのご協力が得られれば幸いです。よろしくお願い致します。
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <ol class="snsb" style="margin-left: 13px">
	<li><a href="http://www.railscp.org/text/" target="_blank"><img src="images/railscp_logo.png" width="150px"/></a></li>
      </ol>
      <ol class="snsb" style="margin-left: 13px">
	<li><iframe src="http://ghbtns.com/github-btn.html?user=yasslab&repo=railsguides.jp&type=watch&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="80" height="20"></iframe></li>
	<li><a href="http://b.hatena.ne.jp/entry/railsguides.jp" class="hatena-bookmark-button" data-hatena-bookmark-title="Ruby on Rails ガイド：体系的に Rails を学ぼう (Rails 4.2 対応)" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script></li>
	<li><div class="fb-like" data-href="http://railsguides.jp/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div></li>
	<li><a href="https://twitter.com/share" class="twitter-share-button" data-url="http://railsguides.jp/" data-text="Ruby on Rails ガイド：体系的に Rails を学ぼう (Rails 4.2 対応)" data-lang="ja" data-hashtags="railsguidesjp">ツイート</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></li>
      </ol>
      <ol class="snsb" style="margin-left: 13px">
	<li>本ガイドは<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.ja">クリエイティブ・コモンズ 表示-継承 4.0 国際</a> (CC BY-SA 4.0) ライセンスに基づいて公開されています。</li>
	<li>「Rails」および「Ruby on Rails」という名称、そして Rails のロゴは、David Heinemeier Hansson による登録商標で、すべての権利を有しています。</li>
      </ol>
    </div>
  </div>
</h5>
  <script type="text/javascript" src="javascripts/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/responsive-tables.js"></script>
  <script type="text/javascript" src="javascripts/guides.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shCore.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushRuby.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushXml.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushSql.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushPlain.js"></script>
  <script type="text/javascript">
    SyntaxHighlighter.all();
    $(guidesIndex.bind);
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-50163209-4', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
